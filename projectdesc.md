Общая архитектура проекта
Система из трёх агентов (логически раздельные модули/классы), которые обмениваются сообщениями через общий «шлюз» или шину сообщений.​

MarketMonitoringAgent

Забирает котировки/историю с реального API (например, Alpha Vantage или Yahoo Finance/yfinance).​

Периодически отправляет агрегированную информацию Decision‑агенту (цены, скользящие средние, индикаторы).

DecisionMakingAgent

Получает данные от MarketMonitoringAgent.

Преобразует их в признаки и подаёт в ML‑модель (логистическая регрессия, random forest, простая LSTM и т.п.).​

Возвращает сигнал BUY / SELL / HOLD + уверенность, риск и т.п.

ExecutionAgent

Получает решения от DecisionMakingAgent.

«Исполняет» сделки в симуляции (псевдо‑портфель, баланс, открытые позиции).

Возвращает подтверждение + обновлённое состояние портфеля.

Коммуникацию между агентами удобно строить так:

Вариант простой: синхронные вызовы Python‑классов (каждый агент — класс с методом handle_message, а «главный контроллер» прогоняет сообщения по очереди).

Вариант посерьёзнее: очередь сообщений (например, через in‑memory очередь или Redis / RabbitMQ, если хочешь показать настоящий MAS‑подход).​

Источник реальных рыночных данных
Тебе обязателен реальный рынок. Для учебного проекта достаточно бесплатного API:

Alpha Vantage

Бесплатный API‑ключ, до ~5 запросов в минуту / 500 в день.​

Данные: акции, FX, крипта, технические индикаторы сразу из API.

Альтернатива: Yahoo Finance через библиотеку yfinance (часто используется в туториалах и GitHub‑репозиториях по trading‑ботам).​

Практический вариант для минимальной боли:

Берёшь yfinance для истории (например, AAPL, MSFT) и качаешь дневные/часовые свечи за последний год.

Для реального времени можно просто периодически дергать последние цены (или ограничиться историческим backtest, это обычно принимается, если данные реальные).​

AI‑модель: что минимально нормально
Преподаватель явно говорит: нужны не просто if‑условия, а AI‑модель.​

Самый реалистичный и простой стек:

Формируем задачу:

Прогноз направления цены: будет ли цена через 
n
n шагов выше текущей (label 1) или ниже/равной (label 0).

На основе этого выдаём BUY (если p>0.55), SELL (если p<0.45), иначе HOLD.

Признаки (features), которые MarketMonitoringAgent заранее рассчитывает и отправляет:

Нормализованные цены и лог‑доходности.

Скользящие средние (SMA, EMA).

RSI, MACD и т.п. (можно считать через ta‑библиотеки либо руками).​

Модель:

Для дедлайна 7 декабря советуются классические ML‑модели:

LogisticRegression, RandomForestClassifier, XGBoost/LightGBM.

Фреймворк: scikit‑learn — быстрее всего обучить и встроить.​

Pipeline:

Скрипт train_model.py:

Грузит исторические данные.

Генерирует признаки и целевую переменную.

Делит на train/test, обучает модель, сохраняет (pickle/onnx).

DecisionMakingAgent в рантайме загружает эту модель и использует для предсказаний.

Так ты честно закрываешь требование «именно AI‑модель, а не правила».​

Координация и протокол общения агентов
Тебе нужно явно показать:

Какие типы сообщений ходят между агентами.

В каком порядке они работают.

Как обрабатываются ошибки/задержки.

Пример логического протокола:

MarketMonitoringAgent → DecisionMakingAgent:

Тип сообщения: MARKET_SNAPSHOT

Payload:

ticker, timestamp

цена, объём

рассчитанные индикаторы (SMA, RSI, др.)

DecisionMakingAgent → ExecutionAgent:

Тип сообщения: TRADE_DECISION

Payload:

action: BUY/SELL/HOLD

quantity

confidence_score

rationale (текст: «цена выше SMA, модель даёт 0.72 на рост»).

ExecutionAgent → MarketMonitoringAgent / UI:

Тип сообщения: EXECUTION_REPORT

Payload:

выполненное действие

новая позиция, PnL, остаток кэша.

Чтобы красиво показать это на защите:

Нарисуй диаграмму последовательностей (sequence diagram) с шагами времени (t0, t1…).

Покажи лог сообщений в UI (например, карточками: «[10:00:01] MarketAgent → DecisionAgent: …»).


# Полное объяснение: Как должен выглядеть фронт

Я распишу **каждую страницу**, **каждый компонент**, **что там должно быть** и **за что отвечает**.

Это будет подробный гайд специально для Next.js темплейта.

***

## 1. ОБЩАЯ СТРУКТУРА ПРОЕКТА (Next.js)

```
trading-dashboard/
├── app/
│   ├── layout.tsx              # Главный лейаут (Header + Sidebar)
│   ├── page.tsx                # Главная страница (Dashboard)
│   │
│   ├── dashboard/
│   │   └── page.tsx            # Dashboard (может быть синонимом главной)
│   │
│   ├── portfolio/
│   │   └── page.tsx            # Портфель (позиции, баланс, история)
│   │
│   ├── agents/
│   │   └── page.tsx            # Детали агентов (все сообщения, логи)
│   │
│   ├── analytics/
│   │   └── page.tsx            # Аналитика (графики, статистика)
│   │
│   └── settings/
│       └── page.tsx            # Настройки (запуск/пауза/стоп, параметры)
│
├── components/
│   ├── Layout/
│   │   ├── Header.tsx          # Верхняя панель (логотип, время, профиль)
│   │   ├── Sidebar.tsx         # Левая навигация
│   │   └── Footer.tsx          # Нижняя часть (опционально)
│   │
│   ├── Dashboard/
│   │   ├── KPICards.tsx        # Четыре карточки (баланс, P&L, Win%, агенты)
│   │   ├── MarketChart.tsx     # График цены в реальном времени
│   │   ├── AgentStatus.tsx     # Три карточки агентов (статус, последнее действие)
│   │   └── MessageLog.tsx      # Лог сообщений между агентами
│   │
│   ├── Portfolio/
│   │   ├── PortfolioSummary.tsx    # Сумма: баланс, кэш, позиции
│   │   ├── PositionTable.tsx       # Таблица открытых позиций
│   │   ├── TradeHistory.tsx        # История всех сделок
│   │   └── AnalyticsChart.tsx      # График P&L по времени
│   │
│   ├── Agents/
│   │   ├── AgentDetailCards.tsx    # Три больших карточки агентов
│   │   ├── MessageTimeline.tsx     # Timeline всех сообщений
│   │   ├── CommunicationFlow.tsx   # Диаграмма взаимодействия
│   │   └── AgentLogs.tsx           # Логи для отладки
│   │
│   ├── Analytics/
│   │   ├── PnLCurve.tsx            # График PnL (equity curve)
│   │   ├── StatisticsPanel.tsx     # Таблица статистики
│   │   ├── RiskMetrics.tsx         # Риск-метрики
│   │   └── BreakdownChart.tsx      # Дневной/недельный/месячный breakdown
│   │
│   ├── Settings/
│   │   ├── SimulationControls.tsx  # Кнопки Start/Pause/Stop/Reset
│   │   ├── DataSourceSettings.tsx  # Выбор символа, таймфрейма, данных
│   │   ├── ModelSettings.tsx       # Выбор модели, параметры
│   │   └── TradingPreferences.tsx  # Риск, баланс, stop-loss, etc
│   │
│   └── Common/
│       ├── Card.tsx            # Базовый компонент карточки
│       ├── Button.tsx          # Базовый компонент кнопки
│       ├── Modal.tsx           # Модальное окно
│       ├── Spinner.tsx         # Загрузка
│       ├── Alert.tsx           # Алерты ошибок/успеха
│       └── Badge.tsx           # Статус-бэджи (Active, Error, etc)
│
├── lib/
│   ├── api.ts                  # HTTP клиент (fetch или axios)
│   ├── websocket.ts            # WebSocket подключение
│   └── utils.ts                # Утилиты (форматирование, вычисления)
│
├── hooks/
│   ├── useWebSocket.ts         # Hook для WebSocket
│   ├── useRealTimeData.ts      # Hook для live данных
│   ├── usePortfolio.ts         # Hook для портфеля
│   └── useAgents.ts            # Hook для агентов
│
├── context/
│   └── AppContext.tsx          # Глобальный контекст (вместо Redux/Zustand)
│
├── types/
│   └── index.ts                # Все TypeScript типы
│
├── styles/
│   └── globals.css             # Глобальные стили + Tailwind
│
└── public/
    └── assets/
        └── logo.svg            # Логотип
```

***

## 2. ГЛАВНАЯ СТРАНИЦА: DASHBOARD (`/`)

### Макет:

```
┌─────────────────────────────────────────────────────────────┐
│  HEADER                                                     │
├──────────────┬──────────────────────────────────────────────┤
│              │                                              │
│   SIDEBAR    │  ┌── KPI CARDS (4 штуки) ───────────────┐  │
│              │  │ $10,245  | +$245  | 68.5% | ✓ Active │  │
│              │  └──────────────────────────────────────┘  │
│              │                                              │
│              │  ┌── MARKET CHART ──────────────────────┐  │
│              │  │                                      │  │
│              │  │    ╱╲                               │  │
│              │  │   ╱  ╲___                           │  │
│              │  │  ╱         ╲                        │  │
│              │  │                                      │  │
│              │  │ [15m] [1h] [4h] [1d]               │  │
│              │  └──────────────────────────────────────┘  │
│              │                                              │
│              │  ┌── AGENT STATUS (3 штуки) ────────────┐  │
│              │  │ [Market] [Decision] [Execution]      │  │
│              │  └──────────────────────────────────────┘  │
│              │                                              │
│              │  ┌── RECENT MESSAGES ──────────────────┐   │
│              │  │ • Agent1 → Agent2 (10:32:01)       │   │
│              │  │ • Agent2 → Agent3 (10:32:02)       │   │
│              │  └──────────────────────────────────────┘   │
└──────────────┴──────────────────────────────────────────────┘
```

### Компоненты на этой странице:

#### **1. KPI Cards** — Четыре метрик-карточки

```typescript
// Каждая карточка показывает:

Card 1: Portfolio Balance
├─ Иконка (💼 кошелька)
├─ Label: "Portfolio Balance"
├─ Большое число: "$10,245.50"
└─ Изменение: "+$245.50 (+2.4%)" (зелёное если +)

Card 2: Today's P&L
├─ Иконка (📈 восходящей стрелки)
├─ Label: "Today's P&L"
├─ Большое число: "$245.50"
└─ Доп информация: "12 trades"

Card 3: Win Rate
├─ Иконка (📊 процента)
├─ Label: "Win Rate"
├─ Большое число: "68.5%"
└─ Progress bar (зелёный)

Card 4: Agents Status
├─ Иконка (⚡ молнии)
├─ Label: "Agents Status"
├─ Большое число/текст: "All Active" или "Error"
└─ Количество: "3 active"
```

**За что отвечает:**
- Показывает главные KPI пользователю
- Все цифры live (обновляются каждую секунду)
- Отправляются с backend по WebSocket
- Цвета: зелёный если хорошо, красный если плохо

***

#### **2. Market Chart** — График цены в реальном времени

```
┌─────────────────────────────────────────┐
│ AAPL Price Chart        [$150.32]       │
├─────────────────────────────────────────┤
│ [15m] [1h] [4h] [1d]                   │  ← Таймфрейм
├─────────────────────────────────────────┤
│                                         │
│         ╱╲         ╱╲                  │
│    ╱╲ ╱  ╲       ╱  ╲       ╱╲         │  ← Line chart
│   ╱  ╲    ╲     ╱    ╲_____╱  ╲       │
│  ╱    ╲    ╲___╱            ╲         │
│                                         │
│ 10:00  10:15  10:30  10:45  11:00     │  ← X-ось (время)
└─────────────────────────────────────────┘
```

**За что отвечает:**
- Показывает изменение цены AAPL в реальном времени
- Линия плавная, без скачков (smooth animation)
- На hover показывает точное значение и время
- Можно выбрать таймфрейм (15m, 1h, 4h, 1d)
- Данные получаются с backend по WebSocket
- На график наносятся точки сделок (зелёные = BUY, красные = SELL)

***

#### **3. Agent Status Cards** — Три карточки агентов

```
┌──────────────────────┐ ┌──────────────────────┐ ┌──────────────────────┐
│ 🔧 Market Monitor    │ │ 🧠 Decision Making   │ │ ⚙️ Execution         │
│                      │ │                      │ │                      │
│ Status: ✓ ACTIVE     │ │ Status: ✓ ACTIVE     │ │ Status: ✓ ACTIVE     │
│ (зелёная левая борд) │ │ (зелёная левая борд) │ │ (зелёная левая борд) │
│                      │ │                      │ │                      │
│ Last action:         │ │ Last action:         │ │ Last action:         │
│ "Fetched price data" │ │ "Generated BUY"      │ │ "Executed trade"     │
│                      │ │                      │ │                      │
│ Updated: 10:32:15    │ │ Updated: 10:32:14    │ │ Updated: 10:32:13    │
│ Messages: 24         │ │ Messages: 18         │ │ Messages: 12         │
│                      │ │                      │ │                      │
│ [View Details →]     │ │ [View Details →]     │ │ [View Details →]     │
└──────────────────────┘ └──────────────────────┘ └──────────────────────┘
```

**За что отвечает:**
- Показывает статус трёх агентов (Active/Idle/Error)
- Левая граница (border) меняет цвет: зелёная = active, красная = error
- Показывает последнее действие каждого агента
- Количество обработанных сообщений
- Время последнего обновления
- Клик на "View Details" открывает подробную информацию

***

#### **4. Message Log** — Лог сообщений между агентами

```
┌─ Agent Communication Feed ────────────────────┐
│                                               │
│ • 10:32:01 MarketAgent → DecisionAgent        │
│   MARKET_SNAPSHOT                             │
│   "Price=$150.32, SMA=149.15, RSI=65.2"       │
│                                               │
│ • 10:32:02 DecisionAgent → ExecutionAgent     │
│   TRADE_DECISION                              │
│   "Action=BUY, Confidence=72.1%"              │
│                                               │
│ • 10:32:03 ExecutionAgent → System            │
│   EXECUTION_REPORT                            │
│   "Trade executed: +$5 P&L"                   │
│                                               │
│ [Auto-scrolls to newest at bottom]            │
└─────────────────────────────────────────────┘
```

**За что отвечает:**
- Timeline визуализация с точечками и линиями
- Показывает ВСЕ сообщения между агентами в хронологическом порядке
- Каждое сообщение содержит:
  - От кого → кому
  - Тип (MARKET_SNAPSHOT, TRADE_DECISION, EXECUTION_REPORT)
  - Содержание
  - Метаданные (action, confidence, price)
- Auto-scroll к новым сообщениям
- Максимум 100 последних сообщений (потом удаляются)

***

## 3. PORTFOLIO PAGE (`/portfolio`)

### Макет:

```
┌──────────────────────────────────────────────────────────┐
│ PORTFOLIO SUMMARY                                        │
├──────────────────────────────────────────────────────────┤
│ Balance: $10,245 | Free Cash: $5,245 | Used Margin: $5,000
│ Total Trades: 45 | Today's P&L: +$245 | Total P&L: +$2,450
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│ OPEN POSITIONS                                           │
├────────┬───────┬────────┬─────────┬────────┬──────────────┤
│ Symbol │ Qty   │ Entry  │ Current │ P&L    │ Action       │
├────────┼───────┼────────┼─────────┼────────┼──────────────┤
│ AAPL   │ 100   │ $148   │ $150.32 │ +$182  │ [Close]      │
│ MSFT   │ 50    │ $320   │ $318    │ -$100  │ [Close]      │
└────────┴───────┴────────┴─────────┴────────┴──────────────┘

┌──────────────────────────────────────────────────────────┐
│ TRADE HISTORY (Last 20)                                  │
├──────────┬────┬───────┬─────────┬───────┬────────────────┤
│ Time     │ Act│ Price │ Qty     │ Agent │ P&L            │
├──────────┼────┼───────┼─────────┼───────┼────────────────┤
│ 10:32:03 │BUY │$150.32│ 100     │Market │ -              │
│ 10:15:00 │SELL│$149.50│ 50      │Market │ +$45.00        │
└──────────┴────┴───────┴─────────┴───────┴────────────────┘

┌──────────────────────────────────────────────────────────┐
│ EQUITY CURVE (График P&L по времени)                     │
│                    ╱╲                                    │
│          ╱╲       ╱  ╲        ╱╲                        │
│    ╱╲   ╱  ╲_____╱    ╲______╱  ╲                       │
│___╱  ╲_╱                                                 │
│                                                          │
│ Max Drawdown: -$125 | Sharpe: 1.24                      │
└──────────────────────────────────────────────────────────┘
```

### Компоненты на этой странице:

#### **1. Portfolio Summary** — Сумма портфеля

```
Показывает:
├─ Balance: $10,245
├─ Free Cash: $5,245
├─ Used Margin: $5,000
├─ Total Trades: 45
├─ Today's P&L: +$245
└─ Total P&L: +$2,450
```

***

#### **2. Position Table** — Таблица открытых позиций

```
Колонки:
├─ Symbol (AAPL, MSFT, etc)
├─ Quantity (100, 50, etc)
├─ Entry Price ($148, $320)
├─ Current Price ($150.32, $318)
├─ P&L ($182, -$100)
│  └─ Зелёное если +, красное если -
├─ P&L % (+1.2%, -0.5%)
└─ Action (кнопка [Close] для закрытия позиции)
```

**За что отвечает:**
- Показывает все открытые позиции
- Live обновление цен
- Расчёт P&L в реальном времени

***

#### **3. Trade History** — История сделок

```
Колонки:
├─ Time (10:32:03)
├─ Action (BUY/SELL)
├─ Price ($150.32)
├─ Quantity (100)
├─ Agent (MarketMonitoring)
└─ P&L (+$45.00 или "-" для текущих)

Сортировка: по времени (новые вверху)
Фильтры: по агенту, по действию (BUY/SELL)
```

***

#### **4. Equity Curve** — График истории P&L

```
Показывает:
├─ X-ось: время (часы/дни)
├─ Y-ось: P&L ($)
├─ Линия: как меняется портфель во времени
├─ Максимальный drawdown
└─ Sharpe ratio

Под графиком:
├─ Max Drawdown: -$125
├─ Max Gain: +$350
├─ Sharpe Ratio: 1.24
└─ Total Return: +$2,450
```

***

## 4. AGENTS PAGE (`/agents`)

### Макет:

```
┌─────────────────┬──────────────────┬──────────────────┐
│ Market Monitoring│ Decision Making  │ Execution        │
│ Status: ACTIVE   │ Status: ACTIVE   │ Status: ACTIVE   │
│ Messages: 24     │ Messages: 18     │ Messages: 12     │
│ [Logs] [History] │ [Logs] [History] │ [Logs] [History] │
└─────────────────┴──────────────────┴──────────────────┘

┌───────────────────────────────────────────────────────┐
│ ALL MESSAGES (TIMELINE)                               │
├───────────────────────────────────────────────────────┤
│ Filter: [All] [→ Market] [→ Decision] [→ Execution]  │
│                                                       │
│ • MarketAgent → DecisionAgent (10:32:01)             │
│   MARKET_SNAPSHOT                                    │
│   Price=$150.32, SMA=149.15, RSI=65.2               │
│                                                       │
│ • DecisionAgent → ExecutionAgent (10:32:02)          │
│   TRADE_DECISION                                     │
│   Action=BUY, Confidence=72.1%, Price=$150.32       │
│                                                       │
│ • ExecutionAgent → Portfolio (10:32:03)              │
│   EXECUTION_REPORT                                   │
│   Trade: BUY 100 @ $150.32, P&L=+$5                 │
│                                                       │
│ [Load more...]                                       │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ COMMUNICATION FLOW (ДИАГРАММА)                        │
├───────────────────────────────────────────────────────┤
│                                                       │
│    ┌──────────────┐                                   │
│    │   Market     │ ← Fetches real data              │
│    │  Monitoring  │                                   │
│    └──────┬───────┘                                   │
│           │ MARKET_SNAPSHOT                           │
│           │ (price, SMA, RSI)                        │
│           ↓                                           │
│    ┌──────────────┐                                   │
│    │  Decision    │ ← Runs ML model                  │
│    │   Making     │                                   │
│    └──────┬───────┘                                   │
│           │ TRADE_DECISION                            │
│           │ (BUY/SELL/HOLD, confidence)             │
│           ↓                                           │
│    ┌──────────────┐                                   │
│    │ Execution    │ ← Executes trade                 │
│    │              │                                   │
│    └──────────────┘                                   │
└───────────────────────────────────────────────────────┘
```

### Компоненты на этой странице:

#### **1. Agent Detail Cards** — Три больших карточки агентов

```
Каждая карточка содержит:
├─ Название агента
├─ Status: ACTIVE / IDLE / ERROR (с цветным бэджем)
├─ Всего обработано сообщений: 24
├─ Последнее действие: "Fetched price data"
├─ Время последнего обновления: 10:32:15
├─ Список последних 5 сообщений (быстрый preview)
└─ [View Logs] кнопка для подробных логов
```

***

#### **2. Message Timeline** — Полный лог всех сообщений

```
Функции:
├─ Показывает ВСЕ когда-либо отправленные сообщения
├─ Фильтры:
│  ├─ [All] — все сообщения
│  ├─ [→ Market] — только к MarketAgent
│  ├─ [→ Decision] — только к DecisionAgent
│  └─ [→ Execution] — только к ExecutionAgent
├─ Сортировка: по времени (новые вверху)
├─ Поиск: по содержанию или типу
└─ Пагинация или infinite scroll
```

***

#### **3. Communication Flow Diagram** — Диаграмма взаимодействия

```
Визуализирует:
├─ Три прямоугольника (агенты)
├─ Стрелки между ними (сообщения)
│  ├─ Market → Decision (MARKET_SNAPSHOT)
│  ├─ Decision → Execution (TRADE_DECISION)
│  └─ Execution → System (EXECUTION_REPORT)
└─ Анимация потока сообщений (импульсы по стрелкам)
```

***

#### **4. Agent Logs** — Детальные логи

```
Для каждого агента показывает:
├─ Стандартный вывод (console.log)
├─ Ошибки (если есть)
├─ Время каждого события
└─ Debug информацию

Пример:
[10:32:01] MarketMonitoringAgent.fetch_market_data()
[10:32:01]   ✓ Fetched AAPL: $150.32
[10:32:01]   INFO: SMA20=149.15, RSI=65.2
[10:32:02] MarketMonitoringAgent.send_message()
[10:32:02]   ✓ Sent to DecisionMaking
```

***

## 5. ANALYTICS PAGE (`/analytics`)

### Макет:

```
┌───────────────────────────────────────────────────────┐
│ PERFORMANCE METRICS                                   │
├───────────────────────────────────────────────────────┤
│ Total Return: +$2,450 | Sharpe Ratio: 1.24           │
│ Win Rate: 68.5% | Profit Factor: 2.45                │
│ Max Drawdown: -$1,250 | Total Trades: 45             │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ PnL CURVE (EQUITY CURVE)                              │
│                                                       │
│                          ╱╲                          │
│              ╱╲         ╱  ╲      ╱                  │
│    ╱╲       ╱  ╲       ╱    ╲____╱                   │
│   ╱  ╲_____╱    ╲_____╱                              │
│  ╱                                                    │
│ ────────────────────────────────────                 │
│                                                       │
│ $10,000 ────────── Initial Balance                   │
│ $12,450 ────────── Current Balance                   │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ STATISTICS TABLE                                      │
├─────────────────────────────────────────────────────┤
│ Total Trades: 45          Winning Trades: 31        │
│ Losing Trades: 14         Win Rate: 68.5%           │
│ Avg Win: $245.50          Avg Loss: -$125.30        │
│ Win/Loss Ratio: 1.96:1    Profit Factor: 2.45       │
│ Sharpe Ratio: 1.24        Max Drawdown: -$1,250     │
│ Total Return: +$2,450     Return %: +24.5%          │
└─────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ MONTHLY BREAKDOWN                                     │
├───────────────────────────────────────────────────────┤
│ Today: +$245     Yesterday: +$125     This Week: +$1,245
│ [Dec 2024: +$1,450] [Nov 2024: +$1,000] [Oct 2024: +$0]
└───────────────────────────────────────────────────────┘
```

### Компоненты на этой странице:

#### **1. Performance Metrics** — Сумма показателей

```
Показывает на одной строке:
├─ Total Return: +$2,450
├─ Sharpe Ratio: 1.24
├─ Win Rate: 68.5%
├─ Profit Factor: 2.45
├─ Max Drawdown: -$1,250
└─ Total Trades: 45
```

***

#### **2. PnL Curve Chart** — График equity curve

```
Функции:
├─ X-ось: время (часы/дни)
├─ Y-ось: баланс портфеля ($)
├─ Линия: как меняется баланс
├─ Grid для удобства читания
├─ Hover: показывает точное значение
└─ Горизонтальная линия: initial balance ($10,000)
```

***

#### **3. Statistics Table** — Таблица всей статистики

```
Показывает:
├─ Общие метрики
│  ├─ Total Trades: 45
│  ├─ Winning Trades: 31
│  ├─ Losing Trades: 14
│  ├─ Win Rate: 68.5%
│
├─ Средние величины
│  ├─ Avg Win: $245.50
│  ├─ Avg Loss: -$125.30
│  ├─ Win/Loss Ratio: 1.96:1
│  └─ Profit Factor: 2.45
│
└─ Риск метрики
   ├─ Sharpe Ratio: 1.24
   ├─ Max Drawdown: -$1,250
   ├─ Total Return: +$2,450
   └─ Return %: +24.5%
```

***

#### **4. Monthly Breakdown** — Дневной/недельный/месячный breakdown

```
Показывает P&L по периодам:
├─ Today: +$245
├─ Yesterday: +$125
├─ This Week: +$1,245
├─ Dec 2024: +$1,450
├─ Nov 2024: +$1,000
└─ Oct 2024: +$0
```

***

## 6. SETTINGS PAGE (`/settings`)

### Макет:

```
┌───────────────────────────────────────────────────────┐
│ SIMULATION CONTROLS                                   │
├───────────────────────────────────────────────────────┤
│ Status: ⏸ PAUSED                                      │
│                                                       │
│ [▶️ START] [⏸ PAUSE] [⏹ STOP] [🔄 RESET]            │
│                                                       │
│ Simulation Speed: [1x ▼] (0.5x | 1x | 2x | 4x)      │
│                                                       │
│ └─ INFO: Будет обновлять данные в 4x быстрее       │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ DATA SOURCE SETTINGS                                  │
├───────────────────────────────────────────────────────┤
│ Symbol: [AAPL ▼]                                      │
│ Timeframe: [1h ▼]                                    │
│ Data Provider: [Yahoo Finance ▼]                     │
│ History Length: [Last 1 year ▼]                      │
│                                                       │
│ └─ INFO: Загружает дневные/часовые данные            │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ MODEL SETTINGS                                        │
├───────────────────────────────────────────────────────┤
│ Model Type: [Random Forest ▼]                         │
│ Prediction Horizon: [1 hour ▼]                       │
│ Confidence Threshold: [0.55] ← 0.75 →               │
│ Feature Normalization: [ON]                          │
│                                                       │
│ [Load Model] [Train New] [Upload Custom]             │
│                                                       │
│ └─ INFO: Текущая accuracy на test set: 52.3%        │
└───────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────┐
│ TRADING PREFERENCES                                   │
├───────────────────────────────────────────────────────┤
│ Initial Balance: [$10,000]                            │
│ Max Position Size: [50%]                             │
│ Risk Level: [Medium ▼] (Low | Medium | High)         │
│ Stop Loss: [-2%]                                     │
│ Take Profit: [+5%]                                   │
│ Max Leverage: [1.0]                                  │
│                                                       │
│ [Save Settings] [Reset to Defaults]                  │
│                                                       │
│ └─ INFO: Применяется при следующем запуске          │
└───────────────────────────────────────────────────────┘
```

### Компоненты на этой странице:

#### **1. Simulation Controls** — Управление симуляцией

```
Кнопки:
├─ START (зелёная) — запустить симуляцию
├─ PAUSE (жёлтая) — пауза
├─ STOP (красная) — остановить и сбросить
└─ RESET (серая) — вернуть всё в начальное состояние

Speed slider:
├─ 0.5x (медленнее)
├─ 1x (нормально)
├─ 2x (быстро)
└─ 4x (очень быстро)

Info:
└─ "Симуляция РАБОТАЕТ. Обновляется каждые 1 сек."
```

***

#### **2. Data Source Settings** — Настройки источника данных

```
Выбор символа:
├─ Дропдаун: [AAPL ▼]
├─ Варианты: AAPL, MSFT, GOOGL, TSLA, etc
└─ INFO: "Загружает последний 1 год дневных данных"

Выбор таймфрейма:
├─ Дропдаун: [1h ▼]
├─ Варианты: 5m, 15m, 1h, 4h, 1d
└─ INFO: "Для симуляции используется исторический данные"

История:
├─ Дропдаун: [Last 1 year ▼]
├─ Варианты: Last month, Last 3m, Last 6m, Last 1y, All
└─ INFO: "Больше данных = точнее модель, но медленнее"
```

***

#### **3. Model Settings** — Настройки ML-модели

```
Выбор модели:
├─ Дропдаун: [Random Forest ▼]
├─ Варианты: Random Forest, Logistic Regression, XGBoost, LSTM
└─ INFO: "Random Forest показывает accuracy 52.3%"

Горизонт предсказания:
├─ Дропдаун: [1 hour ▼]
├─ Варианты: 15m, 30m, 1h, 4h, 1d
└─ INFO: "Модель предсказывает цену на N времени вперёд"

Confidence Threshold:
├─ Slider: [0.55] ← 0.75 →
├─ INFO: "Если вероятность > 0.55, даём сигнал BUY/SELL"
└─ Если < 0.55 и > 0.45, то HOLD

Кнопки:
├─ [Load Model] — загрузить сохранённую модель
├─ [Train New] — переобучить на новых данных
└─ [Upload Custom] — загрузить свою модель (pickle file)
```

***

#### **4. Trading Preferences** — Торговые предпочтения

```
Начальный баланс:
├─ Input: [$10,000]
├─ Min: $1,000, Max: $1,000,000
└─ INFO: "Портфель будет сброшен до этого значения"

Max Position Size:
├─ Slider: [50%]
├─ Range: 10% - 100%
└─ INFO: "Максимум 50% баланса в одной позиции"

Risk Level:
├─ Дропдаун: [Medium ▼]
├─ Варианты: Low | Medium | High
└─ INFO: "Low = консервативный, High = агрессивный"

Stop Loss:
├─ Input: [-2%]
└─ INFO: "Закрывать позицию если потеря > 2%"

Take Profit:
├─ Input: [+5%]
└─ INFO: "Закрывать позицию если прибыль > 5%"

Max Leverage:
├─ Input: [1.0]
├─ Range: 1.0 - 10.0
└─ INFO: "1.0 = без кредита, 2.0 = удвоенная позиция"

Кнопки:
├─ [Save Settings] — сохранить и применить
└─ [Reset to Defaults] — вернуть стандартные значения
```

***

## 7. LAYOUT КОМПОНЕНТЫ (используются на ВСЕХ страницах)

### Header.tsx

```
┌──────────────────────────────────────────────────┐
│ Logo | "Trading Dashboard" | Time | 🌙 | Profile│
└──────────────────────────────────────────────────┘

Слева:
├─ Кнопка меню (☰) для мобильного
├─ Логотип (может быть изображением или текстом)
└─ "Multi-Agent Trading Dashboard"

В центре:
└─ Текущее время (10:32 AM, auto-update каждую сек)

Справа:
├─ Toggle Dark/Light mode (🌙 или ☀️)
└─ Профиль (аватар + дропдаун)
```

**За что отвечает:**
- Остаётся на месте при скролле (sticky)
- Показывает текущее время (live)
- Переключатель тёмного режима
- На мобильном — кнопка для открытия сайдбара

***

### Sidebar.tsx

```
Десктоп (> 1024px):
┌──────────────────┐
│ Dashboard        │ ← Активный пункт (выделен синим)
│ Portfolio        │
│ Agents           │
│ Analytics        │
│ Settings         │
│                  │
│ Logout           │
└──────────────────┘

Мобильный (< 1024px):
┌──────────────────┐
│ ✕ Закрыть        │
│                  │
│ Dashboard        │
│ Portfolio        │
│ Agents           │
│ Analytics        │
│ Settings         │
│                  │
│ Logout           │
└──────────────────┘
```

**За что отвечает:**
- Левая боковая панель с навигацией
- На десктопе всегда видна (ширина ~256px)
- На мобильном выезжает из левого края
- Текущая страница выделена синим цветом
- Клики переводят на нужную страницу
- На мобильном есть кнопка закрытия (✕)

***

## 8. КОМПОНЕНТЫ ОБЩЕГО НАЗНАЧЕНИЯ (Common)

### Card.tsx

```typescript
// Базовый компонент карточки, используется везде

<Card className="p-6 rounded-lg">
  <h2>Заголовок</h2>
  <p>Содержимое</p>
</Card>

// Визуально:
┌─────────────────────────┐
│ Заголовок               │
├─────────────────────────┤
│ Содержимое              │
└─────────────────────────┘
```

***

### Button.tsx

```typescript
// Варианты кнопок

<Button variant="primary">Start</Button>   // Синяя
<Button variant="secondary">Reset</Button> // Серая
<Button variant="danger">Stop</Button>     // Красная
<Button variant="success">Save</Button>    // Зелёная
<Button disabled>Disabled</Button>         // Неактивная
<Button loading>Loading...</Button>        // С спиннером
```

***

### Badge.tsx

```typescript
// Статус-бэджи

<Badge status="active">Active</Badge>     // Зелёный
<Badge status="idle">Idle</Badge>         // Серый
<Badge status="error">Error</Badge>       // Красный
<Badge status="warning">Warning</Badge>   // Жёлтый
```

***

### Modal.tsx

```typescript
// Модальное окно

<Modal isOpen={true} onClose={handleClose}>
  <h2>Заголовок</h2>
  <p>Содержимое</p>
  <button>Закрыть</button>
</Modal>

// Визуально:
[Полупрозрачный тёмный фон]
┌─────────────────────────────┐
│ Заголовок           [✕]     │
├─────────────────────────────┤
│ Содержимое                  │
│                             │
│ [Отмена] [OK]               │
└─────────────────────────────┘
```

***

```

***

## 10. REACT HOOKS ИСПОЛЬЗУЕМЫЕ

### useWebSocket.ts

```typescript
// Подключается к WebSocket бэка
// Получает live данные (цены, сообщения, статусы)

const ws = useWebSocket('ws://localhost:8000/ws');
// ws.on('message', (data) => update UI)
```

***

### useRealTimeData.ts

```typescript
// Получает и обновляет данные в реальном времени

const { portfolio, agents, price, messages } = useRealTimeData();
// Все автоматически обновляются по WebSocket
```

***

### usePortfolio.ts

```typescript
// Работает с портфелем

const {
  balance,
  positions,
  totalPnL,
  closePosition,
  updateBalance
} = usePortfolio();
```

***

### useAgents.ts

```typescript
// Работает с агентами и сообщениями

const {
  agents,
  messages,
  startSimulation,
  pauseSimulation,
  stopSimulation
} = useAgents();
```

***

## 11. РАЗМЕР И АДАПТИВНОСТЬ

### Breakpoints

```
Mobile: < 640px
  - Sidebar убирается, становится меню
  - Компоненты в один столбец (width: 100%)
  - Font-size меньше

Tablet: 640px - 1024px
  - Sidebar может быть или убран
  - Компоненты в 2-3 столбца
  - Normal font-size

Desktop: > 1024px
  - Sidebar всегда видна слева
  - Компоненты в 3-4 столбца
  - Full-size font
```

### Примеры

```typescript
// KPI Cards
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
// Мобиль: 1 колонка
// Планшет: 2 колонки
// Десктоп: 4 колонки

// Chart
<div className="h-64 md:h-80 lg:h-96">
// Разная высота на разных размерах
```

***

## РЕЗЮМЕ: ЧТО ГДЕ И ЗА ЧТО ОТВЕЧАЕТ

| Страница | Что показывает | За что отвечает |
|----------|---|---|
| `/` (Dashboard) | KPI + Chart + Агенты + Лог | Главный экран, overview |
| `/portfolio` | Позиции + История + Equity curve | Управление портфелем |
| `/agents` | Детали агентов + Timeline + Диаграмма | Мониторинг взаимодействия |
| `/analytics` | Графики + Статистика + Breakdown | Анализ производительности |
| `/settings` | Контролы + Настройки | Конфигурация системы |

| Компонент | Где используется | За что отвечает |
|-----------|---|---|
| Header | Везде | Верхняя панель, время, профиль |
| Sidebar | Везде | Навигация по страницам |
| KPICards | Dashboard | 4 главных метрики |
| MarketChart | Dashboard, Analytics | График цены |
| AgentStatus | Dashboard, Agents | Статус трёх агентов |
| MessageLog | Dashboard, Agents | Лог коммуникаций |
| PositionTable | Portfolio | Открытые позиции |
| TradeHistory | Portfolio | История сделок |

***
